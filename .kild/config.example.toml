# KILD Configuration - All Options
#
# Config files are loaded in order (later overrides earlier):
#   1. Hardcoded defaults
#   2. User config:    ~/.kild/config.toml
#   3. Project config: ./.kild/config.toml
#   4. CLI flags
#
# Copy this file to ~/.kild/config.toml for user-wide settings
# or to .kild/config.toml in your project for project-specific settings.

# =============================================================================
# AGENT CONFIGURATION
# =============================================================================

[agent]
# Default agent when --agent is not specified
# Options: amp, claude, codex, gemini, kiro, opencode
default = "claude"

# Global startup command (used if agent has no specific command)
# startup_command = "claude"

# Global flags appended to all agent commands
# flags = "--trust-all-tools"

# =============================================================================
# TERMINAL CONFIGURATION
# =============================================================================

[terminal]
# Preferred terminal emulator
# Options: ghostty, iterm2, iterm, terminal, alacritty, native, auto
# "auto" detects available terminal per platform:
#   macOS: Ghostty > iTerm > Terminal.app
#   Linux: Alacritty (requires Hyprland window manager)
preferred = "ghostty"

# =============================================================================
# PER-AGENT SETTINGS
# Override global agent settings for specific agents
# =============================================================================

[agents.claude]
# Command to launch Claude
startup_command = "claude"
# Flags specific to Claude
# flags = "--dangerously-skip-permissions"

[agents.kiro]
startup_command = "kiro-cli chat"
# flags = "--trust-all-tools"

[agents.gemini]
startup_command = "gemini-cli"

[agents.codex]
startup_command = "codex"

[agents.opencode]
startup_command = "opencode"

[agents.aider]
startup_command = "aider"

# =============================================================================
# HEALTH MONITORING
# =============================================================================

[health]
# Minutes of inactivity before a kild is considered idle
# Default: 10
idle_threshold_minutes = 10

# Seconds between health check refreshes in watch mode
# Default: 5
refresh_interval_secs = 5

# Enable/disable session history tracking
# Default: false
history_enabled = true

# Days to retain session history
# Default: 7
history_retention_days = 7

# =============================================================================
# FILE INCLUSION PATTERNS
# Files matching these patterns are copied to new worktrees even if gitignored
# =============================================================================

[include_patterns]
# Enable/disable pattern-based file copying
# Default: true
enabled = true

# Glob patterns for files to copy (relative to repo root)
#
# DEFAULT PATTERNS (applied automatically if you don't specify any):
#   - ".env*"           - Environment files
#   - "*.local.json"    - Local config files
#   - ".claude/**"      - Claude AI context files
#   - ".cursor/**"      - Cursor AI context files
#
# Your patterns EXTEND the defaults (not replace).
# User config (~/.kild/config.toml) patterns are also merged with project patterns.
patterns = [
    "build/artifacts/**",  # Project-specific: build artifacts
]

# Maximum file size to copy (skip larger files with warning)
# Supports: "10MB", "1GB", etc.
# max_file_size = "10MB"

# =============================================================================
# EDITOR CONFIGURATION
# =============================================================================

[editor]
# Default editor for `kild code` command
# Precedence: CLI --editor flag > config default > $EDITOR > "zed"
# default = "zed"

# Flags passed to the editor before the worktree path
# Useful for GUI editors that need flags like --new-window
# flags = "--new-window"

# Whether to spawn the editor inside a terminal window
# Required for terminal-based editors (nvim, vim, helix)
# Default: false
# terminal = false

# Example: VS Code
# [editor]
# default = "code"
# flags = "--new-window"
# terminal = false

# Example: Neovim
# [editor]
# default = "nvim"
# flags = "--nofork"
# terminal = true

# =============================================================================
# DAEMON RUNTIME CONFIGURATION (Experimental)
# =============================================================================

[daemon]
# Whether daemon mode is the default for new sessions
# When true, `kild create` uses daemon-owned PTY unless --no-daemon is passed
# When false, `kild create` uses external terminal unless --daemon is passed
# Default: false
enabled = false

# Auto-start the daemon if not running when daemon mode is requested
# Default: true
auto_start = true

# Advanced daemon settings (optional, sensible defaults used if omitted)
# socket_path = "~/.kild/daemon.sock"   # Unix socket location
# pid_path = "~/.kild/daemon.pid"       # PID file location
# scrollback_buffer_size = 262144       # Bytes per session (default: 256 KB)
# pty_output_batch_ms = 4               # PTY output batching interval (ms)
# client_buffer_size = 1048576          # Per-client broadcast buffer (default: 1 MB)
# shutdown_timeout_secs = 5             # Wait for agents to exit on shutdown

# ---------------------------------------------------------------------------
# TCP/TLS — remote daemon access (server-side config)
# Set these on the machine running kild-daemon.
# ---------------------------------------------------------------------------

# Bind a TLS-wrapped TCP listener in addition to the Unix socket.
# Enables CLI and UI on other machines to connect without SSH socket forwarding.
# bind_tcp = "0.0.0.0:7432"

# TLS certificate/key paths. Auto-generated at ~/.kild/certs/ on first start
# if not specified. Only needed to override the auto-generated cert location.
# tls_cert_path = "~/.kild/certs/daemon.crt"
# tls_key_path  = "~/.kild/certs/daemon.key"

# ---------------------------------------------------------------------------
# Remote daemon connection (client-side config)
# Set these on the machine running kild CLI / kild-ui.
# ---------------------------------------------------------------------------

# Connect to a remote daemon instead of the local Unix socket.
# Format: "host:port" — must match bind_tcp on the server.
# remote_host = "build-server:7432"

# SHA-256 fingerprint of the remote daemon's TLS certificate (required when
# remote_host is set). Obtain from the server after first daemon start:
#   openssl x509 -in ~/.kild/certs/daemon.crt -fingerprint -sha256 -noout
# remote_cert_fingerprint = "sha256:aabbcc..."
